<div class="header-container">
  <div class="meta">
    <div class="created-date">
      {{ article.createdAt.toDate() | date : "MMM d, y" }}
    </div>

    <div
      class="category"
      [routerLink]="['/articles/category', article.category]"
    >
      {{ article.category }}
    </div>
  </div>

  <div class="title-toolbar-wrapper">
    <h2 class="title">
      {{ article.title }}
    </h2>

    <div class="toolbar">
      <div class="toolbar-container toolbar-left">
        <div class="author">
          by
          <span [routerLink]="['/users', article.authorId]">{{
            article.authorName
          }}</span>
        </div>

        <div class="likes">
          @if (isOwner) {
          <span class="popup popup-error fade"
            >You can't like your own article</span
          >
          }
          <svg
            xmlns="http://www.w3.org/2000/svg"
            version="1.1"
            viewBox="10 23 85 55"
            [class]="hasLiked ? 'heart-icon liked' : 'heart-icon'"
            (click)="onLike()"
          >
            <title>Like</title>
            <g transform="translate(0,-952.36218)">
              <path
                d="m 18.356844,974.98986 c -7.1459,7.50345 -7.139,19.5777 0,27.08854 l 31.6235,33.2838 c 10.5534,-11.0817 21.1069,-22.1634 31.6603,-33.2453 7.1458,-7.50359 7.1458,-19.58504 0,-27.08864 -7.1458,-7.50358 -18.6513,-7.50375 -25.7972,0 l -5.8264,6.11805 -5.863,-6.15645 c -7.1459,-7.50359 -18.6515,-7.50359 -25.7972,0 z"
              />
            </g>
          </svg>
          <div class="likes-count">
            {{ article.likes }}
          </div>
        </div>
      </div>

      <div class="toolbar-container toolbar-right">
        @if (currentUserId !== article.authorId) {
        <div class="bookmark">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 640 640"
            [class]="hasBookmarked ? 'bookmark-icon checked' : 'bookmark-icon'"
            (click)="bookmark.emit()"
          >
            <title>Save</title>
            <path
              d="M192 64C156.7 64 128 92.7 128 128L128 544C128 555.5 134.2 566.2 144.2 571.8C154.2 577.4 166.5 577.3 176.4 571.4L320 485.3L463.5 571.4C473.4 577.3 485.7 577.5 495.7 571.8C505.7 566.1 512 555.5 512 544L512 128C512 92.7 483.3 64 448 64L192 64z"
            />
          </svg>
        </div>
        }

        <div class="share">
          @if (isCopied) {
          <span class="popup popup-copied fade">Link copied!</span>
          }
          <svg
            xmlns="http://www.w3.org/2000/svg"
            version="1.1"
            viewBox="2 -5 100 100"
            class="share-icon"
            (click)="share.emit()"
          >
            <title>Copy link</title>
            <path
              d="m22.914 55.359c1.6289 0.57031 2.4805 2.3594 1.9062 3.9883-0.57422 1.625-2.3633 2.4766-3.9883 1.9023-3.0508-1.0742-5.8516-2.8242-8.1797-5.1562-4.1016-4.1016-6.4062-9.6641-6.4062-15.461v-0.011718c0-5.8008 2.3047-11.363 6.4062-15.461 4.1016-4.1016 9.6641-6.4062 15.461-6.4062h25.031c5.8008 0 11.363 2.3047 15.465 6.4062 4.1016 4.1016 6.4023 9.6641 6.4023 15.461v0.011718c0 5.8008-2.3047 11.363-6.4023 15.461-4.1016 4.1016-9.6641 6.4062-15.465 6.4062h-12.523c-1.7266 0-3.125-1.3984-3.125-3.125s1.3984-3.125 3.125-3.125h12.523c4.1445 0 8.1172-1.6484 11.043-4.5742 2.9297-2.9297 4.5742-6.8984 4.5742-11.043v-0.011718c0-4.1445-1.6445-8.1172-4.5742-11.043-2.9297-2.9297-6.8984-4.5742-11.043-4.5742h-25.031c-4.1445 0-8.1172 1.6484-11.043 4.5742-2.9297 2.9297-4.5742 6.8984-4.5742 11.043v0.011718c0 4.1445 1.6484 8.1172 4.5742 11.043 1.6641 1.6641 3.6641 2.9141 5.8398 3.6836zm57.297-10.723c-1.6289-0.57422-2.4844-2.3594-1.9102-3.9883 0.57031-1.625 2.3555-2.4805 3.9844-1.9102 3.0547 1.0742 5.8672 2.8281 8.2031 5.1641 4.1016 4.1016 6.4023 9.6641 6.4023 15.461v0.011719c0 5.8008-2.3047 11.363-6.4023 15.461-4.1016 4.1016-9.6641 6.4062-15.465 6.4062h-25.031c-5.8008 0-11.363-2.3047-15.461-6.4062-4.1016-4.1016-6.4062-9.6641-6.4062-15.461v-0.011719c0-5.8008 2.3047-11.363 6.4062-15.461 4.1016-4.1016 9.6641-6.4062 15.461-6.4062h12.508c1.7266 0 3.125 1.3984 3.125 3.125 0 1.7266-1.3984 3.125-3.125 3.125h-12.508c-4.1445 0-8.1172 1.6484-11.043 4.5742-2.9297 2.9297-4.5742 6.8984-4.5742 11.043v0.011719c0 4.1445 1.6484 8.1172 4.5742 11.043 2.9297 2.9297 6.8984 4.5742 11.043 4.5742h25.031c4.1445 0 8.1172-1.6484 11.043-4.5742 2.9297-2.9297 4.5742-6.8984 4.5742-11.043v-0.011719c0-4.1445-1.6445-8.1172-4.5742-11.043-1.6641-1.668-3.6719-2.918-5.8555-3.6875z"
              fill-rule="evenodd"
            />
          </svg>
        </div>

        @if (currentUserId === article.authorId) {
        <div class="controls">
          <div class="more-icon-wrapper" (click)="isMenuOpened = !isMenuOpened">
            <svg
              class="more-icon"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="20 20 60 60"
            >
              &gt;
              <circle cx="8" cy="50" r="15" />
              <circle cx="50" cy="50" r="15" />
              <circle cx="92" cy="50" r="15" />
            </svg>
          </div>

          @if (isMenuOpened) {
          <div class="dropdown-container">
            <a
              class="btn edit-btn"
              [routerLink]="['/articles', articleId, 'edit']"
              >Edit article</a
            >
            <a class="btn delete-btn" (click)="delete.emit()">Delete article</a>
          </div>
          }
        </div>
        }
      </div>
    </div>
  </div>

  <div class="cover-img-wrapper">
    <img [src]="article.thumbnailUrl" alt="Article cover image" />
  </div>
</div>
